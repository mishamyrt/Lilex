---
export type Props = {
	name?: string;
	value?: string | number;
	checked?: boolean;
	class?: string;
	inputClass?: string;
	align?: "caps" | "x-height";
};

const {
	name,
	value,
	checked,
	inputClass,
	class: className,
	align = "caps",
	...props
} = Astro.props;
---

<div
	class:list={["toggle", className, align === "x-height" && "_x-height"]}
	{...props}
>
	<input
		type="checkbox"
		name={name}
		value={value}
		checked={checked}
		class:list={["toggle-input", inputClass]}
	/>
</div>

<style lang="scss">
	.toggle {
		--toggle-border-size: 1px;
		--toggle-base-size: 8px;
		--toggle-width: calc(var(--toggle-base-size) * 5);
		--toggle-height: calc(var(--toggle-base-size) * 3);
		--toggle-border-radius: calc(var(--toggle-height) / 2);
		--knob-gap: 3px;
		--knob-height: calc(var(--toggle-height) - (var(--knob-gap) * 2));
		--knob-width: calc(var(--knob-height) * 1);
		--knob-border-radius: calc(var(--toggle-border-radius) - var(--knob-gap));

		position: relative;
		width: var(--toggle-width);
		height: var(--toggle-height);
		display: inline-block;
		cursor: pointer;

		&._x-height {
			margin-top: 5px;
		}

		&-input {
			width: 0;
			height: 0;
			appearance: none;

			&::before {
				position: absolute;
				top: 0;
				left: 0;
				content: "";
				width: var(--toggle-width);
				height: var(--toggle-height);
				display: block;
				border-radius: var(--toggle-border-radius);
				transition:
					opacity var(--transition-slow),
					background-color var(--transition-slow),
					box-shadow var(--transition-slow);
				background-color: var(--color-content-dimmed);
			}

			&::after {
				content: "";
				position: absolute;
				top: 0;
				left: 0;
				width: var(--knob-width);
				height: var(--knob-height);
				transform: translate(var(--knob-gap), var(--knob-gap));
				display: block;
				transition:
					opacity var(--transition-slow),
					transform var(--transition-slow),
					width var(--transition-slow),
					height var(--transition-slow);
				box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
				background-color: rgba(255, 255, 255, 0.95);
				border-radius: var(--knob-border-radius);
			}

			&:checked {
				&::before {
					background-color: var(--color-background-success);
				}
				&::after {
					transform: translate(
						calc(var(--toggle-width) - var(--knob-width) - var(--knob-gap)),
						var(--knob-gap)
					);
				}
			}

			&:disabled {
				&::before,
				&::after {
					opacity: 0.5;
					cursor: default;
				}
			}
		}
	}

	.toggle:active {
		--knob-gap: 4px;
	}
</style>
